<definition xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" class="vulnerability" id="oval:org.mitre.oval:def:29485" version="3">
  <metadata>
    <title>SQL Server remote code execution vulnerability - CVE-2015-1762 (MS15-058)</title>
    <affected family="windows">
      <platform>Microsoft Windows 7</platform>
      <platform>Microsoft Windows Server 2003</platform>
      <platform>Microsoft Windows Server 2008 R2</platform>
      <platform>Microsoft Windows Server 2008</platform>
      <platform>Microsoft Windows Vista</platform>
      <platform>Microsoft Windows XP</platform>
      <platform>Microsoft Windows Server 2012</platform>
      <platform>Microsoft Windows Server 2012 R2</platform>
      <platform>Microsoft Windows 8</platform>
      <platform>Microsoft Windows 8.1</platform>
      <product>Microsoft SQL Server 2008</product>
      <product>Microsoft SQL Server 2008 R2</product>
      <product>Microsoft SQL Server 2012</product>
      <product>Microsoft SQL Server 2014</product>
    </affected>
    <reference ref_id="CVE-2015-1762" ref_url="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1762" source="CVE" />
    <description>Microsoft SQL Server 2008 SP3 and SP4, 2008 R2 SP2 and SP3, 2012 SP1 and SP2, and 2014, when transactional replication is configured, does not prevent use of uninitialized memory in unspecified function calls, which allows remote authenticated users to execute arbitrary code by leveraging certain permissions and making a crafted query, as demonstrated by the VIEW SERVER STATE permission, aka "SQL Server Remote Code Execution Vulnerability."</description>
    <oval_repository>
      <dates>
        <submitted date="2015-07-22T13:00:00">
          <contributor organization="SecPod Technologies">SecPod Team</contributor>
        </submitted>
        <status_change date="2015-07-23T11:09:50.375-04:00">DRAFT</status_change>
        <status_change date="2015-08-10T04:00:57.044-04:00">INTERIM</status_change>
        <status_change date="2015-12-22T12:30:00.000-05:00">ACCEPTED</status_change>
      </dates>
      <status>ACCEPTED</status>
      <min_schema_version>5.10</min_schema_version>
    </oval_repository>
  </metadata>
  <criteria operator="OR">
    <criteria comment="Microsoft SQL Server 2008 and vulnerable file version" operator="AND">
      <criteria comment="either products" operator="OR">
        <extend_definition comment="Microsoft SQL Server 2008 is installed" definition_ref="oval:org.mitre.oval:def:12454" />
        <extend_definition comment="Microsoft SQL Server 2008 SP3 is installed" definition_ref="oval:org.mitre.oval:def:15497" />
      </criteria>
      <criteria comment="Check for vulnerable version" operator="OR">
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 10.0.5538.0" test_ref="oval:org.mitre.oval:tst:140857" />
        <criteria comment="Check for LDR" operator="AND">
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 10.0.5750.0" test_ref="oval:org.mitre.oval:tst:121683" />
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 10.0.5890.0" test_ref="oval:org.mitre.oval:tst:140253" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Microsoft SQL Server 2008 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2008 Service Pack 4 is installed" definition_ref="oval:org.mitre.oval:def:28999" />
      <criteria comment="Check for vulnerable versions" operator="OR">
        <criteria comment="Check for LDR" operator="AND">
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 10.0.6535.0" test_ref="oval:org.mitre.oval:tst:141246" />
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 10.0.6500.0" test_ref="oval:org.mitre.oval:tst:141186" />
        </criteria>
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 10.0.6241.0" test_ref="oval:org.mitre.oval:tst:141140" />
      </criteria>
    </criteria>
    <criteria comment="Microsoft SQL Server 2008 R2 and vulnerable file version" operator="AND">
      <criteria comment="either products" operator="OR">
        <extend_definition comment="Microsoft SQL Server 2008 R2 is installed" definition_ref="oval:org.mitre.oval:def:12596" />
        <extend_definition comment="Microsoft SQL Server 2008 R2 SP2 is installed" definition_ref="oval:org.mitre.oval:def:15803" />
      </criteria>
      <criteria comment="Check for vulnerable version" operator="OR">
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 10.50.4042.0" test_ref="oval:org.mitre.oval:tst:140756" />
        <criteria comment="Check for LDR" operator="AND">
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 10.50.4251" test_ref="oval:org.mitre.oval:tst:122178" />
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 10.50.4339.0" test_ref="oval:org.mitre.oval:tst:141132" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Microsoft SQL Server 2008 R2 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2008 R2 SP3 is installed" definition_ref="oval:org.mitre.oval:def:28713" />
      <criteria comment="Check for vulnerable version" operator="OR">
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 10.50.6220.0" test_ref="oval:org.mitre.oval:tst:140888" />
        <criteria comment="Check for LDR" operator="AND">
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 10.50.6529.0" test_ref="oval:org.mitre.oval:tst:140717" />
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 10.50.6500.0" test_ref="oval:org.mitre.oval:tst:140270" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="2012 vulnerable version" operator="AND">
      <criteria comment="either products" operator="OR">
        <extend_definition comment="Microsoft SQL Server 2012 is installed" definition_ref="oval:org.mitre.oval:def:15044" />
        <extend_definition comment="Microsoft SQL Server 2012 SP1 is installed" definition_ref="oval:org.mitre.oval:def:21029" />
      </criteria>
      <criteria comment="Check for vulnerable range" operator="OR">
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 11.0.3156.0" test_ref="oval:org.mitre.oval:tst:141009" />
        <criteria comment="Check for LDR range" operator="AND">
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 11.0.3300" test_ref="oval:org.mitre.oval:tst:122379" />
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 11.0.3513.0" test_ref="oval:org.mitre.oval:tst:141172" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="2012 vulnerable version" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2012 SP2 is installed" definition_ref="oval:org.mitre.oval:def:29429" />
      <criteria comment="Check for vulnerable range" operator="OR">
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 11.0.5343.0" test_ref="oval:org.mitre.oval:tst:141193" />
        <criteria comment="Check for LDR range" operator="AND">
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 11.0.5613.0" test_ref="oval:org.mitre.oval:tst:141079" />
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 11.0.5600.0" test_ref="oval:org.mitre.oval:tst:141019" />
        </criteria>
      </criteria>
    </criteria>
    <criteria comment="Microsoft SQL Server 2014 and vulnerable file version" operator="AND">
      <extend_definition comment="Microsoft SQL Server 2014 is installed" definition_ref="oval:org.mitre.oval:def:26140" />
      <criteria comment="Check for vulnerable range" operator="OR">
        <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 12.0.2269.0" test_ref="oval:org.mitre.oval:tst:141088" />
        <criteria comment="Check for LDR" operator="AND">
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is greater than or equal to 12.0.2300" test_ref="oval:org.mitre.oval:tst:122271" />
          <criterion comment="Check if the version of Microsoft.sqlserver.chainer.infrastructure.dll is less than 12.0.2548.0" test_ref="oval:org.mitre.oval:tst:141078" />
        </criteria>
      </criteria>
    </criteria>
  </criteria>
</definition>
